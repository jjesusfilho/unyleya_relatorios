<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="José de Jesus Filho">
<meta name="description" content="Nesta análise, mostramos como coletar e estimar o tempo para apreciação de um pedido de habeas corpos no Tribunal de Justiça de São Paulo.">

<title>Tempo do Habeas Corpus</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="tempo_do_habeas_corpus_files/libs/clipboard/clipboard.min.js"></script>
<script src="tempo_do_habeas_corpus_files/libs/quarto-html/quarto.js"></script>
<script src="tempo_do_habeas_corpus_files/libs/quarto-html/popper.min.js"></script>
<script src="tempo_do_habeas_corpus_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tempo_do_habeas_corpus_files/libs/quarto-html/anchor.min.js"></script>
<link href="tempo_do_habeas_corpus_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tempo_do_habeas_corpus_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tempo_do_habeas_corpus_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tempo_do_habeas_corpus_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tempo_do_habeas_corpus_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tempo do Habeas Corpus</h1>
</div>

<div>
  <div class="description">
    <p>Nesta análise, mostramos como coletar e estimar o tempo para apreciação de um pedido de habeas corpos no Tribunal de Justiça de São Paulo.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>José de Jesus Filho </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="tempo-do-habeas-corpus" class="level2">
<h2 class="anchored" data-anchor-id="tempo-do-habeas-corpus">Tempo do Habeas Corpus</h2>
<p>Nesta análise, mostramos como coletar e estimar o tempo para apreciação de um habeas corpos no Tribunal de Justiça de São Paulo.</p>
<p>Optamos por baixar pedidos de habeas corpus perante o Tribunal de Justiça de São Paulo contra atos de magistrados de primeira instância. Inicialmente, pensamos em analisar o tempo até a apreciação do pedido de liminar. No entanto, nem todos os HCs têm pedido de antecipação cautelar, muitas decisões concedem HC liminarmente independentemente de haver pedido de antecipação. Muitos HCs, mesmo com pedido de liminar, diferem o processamento até a apreciação de mérito. Dessa forma, optamos por observar o tempo entre a entrada no TJSP até a apreciação do mérito, independentemente se este foi decidido liminarmente ou não.</p>
<p>Para esta análise, baixamos <a href="https://github.com/jjesusfilho/unyleya_relatorios/blob/main/docs/hc/base.rds">3174 pedidos</a> de HCs.</p>
<p>Basicamente o que fizemos foi usar a função <code>cnj_sequencial</code> do pacote <a href="https://github.com/courtsbr/JurisMiner">JurisMiner</a> para criar duas sequências de números do CNJ. Uma que começa com 20, outra que começa com 00. Fizemos isso porque notamos que havia dois padrões de numeração. O primeiro, que começa com 20, corresponde a habeas corpus impetrados eletronicamente, geralmente por advogados, especialmente a Defensoria Pública. O segundo, que começa com 00, corresponde a HCs impetrados pelos próprios pacientes ou seus familiares, geralmente presos com pedidos no âmbito da execução penal.</p>
<section id="coleta-dos-dados" class="level3">
<h3 class="anchored" data-anchor-id="coleta-dos-dados">Coleta dos dados</h3>
<p>Adicionei esta seção, somente para documentação do procedimento de coleta. Você pode saltá-la e ir diretamente para a análise. A base utilizada se encontra <a href="colocar%20url">aqui</a>. Veja abaixo como eu fiz. Primeiramente, criei um diretório chamado cpopsg (Consulta de julgados de segundo grau). Depois criei cada uma das sequências e coloquei para baixar os processos.</p>
<p>Note que, antes de usar essas funções, você tem de instalar os pacotes <a href="https://github.com/courtsbr/JurisMiner">JurisMiner</a> e <a href="https://github.com/jjesusfilho/tjsp">tjsp</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"courtsbr/JurisMiner"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jjesusfilho/tjsp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Vamos carregar os pacotes acima e também o tidyverse, pois este é nossa principal ferramenta de ciência de dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JurisMiner)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tjsp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"cposg"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>seq1  <span class="ot">&lt;-</span> <span class="fu">cnj_sequencial</span>(<span class="at">inicio =</span> <span class="dv">2000001</span>, <span class="do">## início da sequência</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fim =</span> <span class="dv">2010000</span>, <span class="do">## fim da sequência</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ano =</span> <span class="dv">2023</span>,  <span class="do">## ano do processo</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">segmento =</span> <span class="dv">8</span>, <span class="do">## Justiça estadual</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">uf =</span> <span class="dv">26</span>, <span class="do">## TJSP</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">distribuidor =</span> <span class="dv">0000</span> <span class="do">## Segunda instância.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>seq2  <span class="ot">&lt;-</span> <span class="fu">cnj_sequencial</span>(<span class="at">inicio =</span> <span class="dv">1</span>, <span class="do">## início da sequência</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fim =</span> <span class="dv">10000</span>, <span class="do">## fim da sequência</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ano =</span> <span class="dv">2023</span>,  <span class="do">## ano do processo</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">segmento =</span> <span class="dv">8</span>, <span class="do">## Justiça estadual</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">uf =</span> <span class="dv">26</span>, <span class="do">## TJSP</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">distribuidor =</span> <span class="dv">0000</span> <span class="do">## Segunda instância.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>sequencia <span class="ot">&lt;-</span> <span class="fu">c</span>(seq1, seq2)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tjsp_baixar_cposg</span>(sequencia, <span class="at">diretorio =</span> <span class="st">"cposg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Depois de baixar os htmls com os metadados processuais, a próxima etapa é ler os dados básicos, a movimentação e a decisão. O pacote <a href="https://github.com/jjesusfilho/tjsp">tjsp</a> possui funções para isso.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>arquivos <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">"cposg"</span>, full. <span class="at">names =</span> <span class="cn">TRUE</span>) <span class="do">## Lista o caminho de cada arquivo</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">tjsp_ler_dados_cposg</span>(arquivos) <span class="do">## importa para o R os dados básicos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esses dados são todos os 20 mil primeiros processos instaurados na segunda instância do TJSP. Eles são, via de regra, ações autônomas. Antes de lermos a movimentação processual, bem como, as decisões, precisamos filtrar para somente aqueles que são habeas corpus criminais.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">filter</span>(<span class="fu">str_detect</span>(classe, <span class="st">"(?i)habeas"</span>)) <span class="do">## Mantêm somente os habeas corpus.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Feito isso, vamos criar uma tabela com os arquivos e, a partir dela, criar uma coluna processo, extrair do nome do arquivo o número do processo para, então, filtrar somente aqueles que são HCs.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">arquivo =</span> arquivos) <span class="sc">|&gt;</span> <span class="do">## Coloca o vetor de arquivos numa coluna de tibble</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cd_processo =</span> <span class="fu">str_extract</span>(arquivo,<span class="st">"(?&lt;=cd_processo_)</span><span class="sc">\\</span><span class="st">w+"</span>)) <span class="do">## extrai os números dos processos.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> tb <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">semi_join</span>(dados, <span class="at">by =</span> <span class="st">"cd_processo"</span>) <span class="do">## Mantêm os arquivos cujos processos são HCs.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Agora podemos ler somente as decisões e movimentações dos processos que são HC.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dispositivos <span class="ot">&lt;-</span> <span class="fu">tjsp_ler_dispositivo</span>(tb<span class="sc">$</span>arquivo)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>movimentacao <span class="ot">&lt;-</span> <span class="fu">tjsp_ler_movimentacao</span>(tb<span class="sc">$</span>arquivo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Vamos visualizar a estrutura dos dados.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 10
Columns: 21
$ processo           &lt;chr&gt; "20000620620238260000", "20000413020238260000", "20…
$ cd_processo        &lt;chr&gt; "RI0079NR30000", "RI0079NQI0000", "RI0079NPG0000", …
$ processo_pg        &lt;chr&gt; "70120300220178260050", "15003077420228260561", "15…
$ digital            &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRU…
$ situacao           &lt;chr&gt; "Arquivado administrativamente", "Arquivado adminis…
$ area               &lt;chr&gt; "Criminal", "Criminal", "Criminal", "Criminal", "Cr…
$ assunto            &lt;chr&gt; "DIREITO PENAL - Crimes Previstos na Legislação Ext…
$ classe             &lt;chr&gt; " Habeas Corpus Criminal\n", " Habeas Corpus Crimin…
$ distribuicao       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, " \n", NA, " \n"
$ orgao_julgador     &lt;chr&gt; " 11ª Câmara de Direito Criminal\n", " 1ª Câmara de…
$ origem             &lt;chr&gt; "Comarca de São Paulo / São Paulo/DEECRIM UR1 / Uni…
$ outros_numeros     &lt;chr&gt; "\n                            \n                  …
$ processo_principal &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
$ recebido_em        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
$ recurso            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
$ relator            &lt;chr&gt; "XAVIER DE SOUZA", "ANDRADE SAMPAIO", "XISTO ALBARE…
$ revisor            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
$ secao              &lt;chr&gt; " Direito Criminal\n", " Direito Criminal\n", " Dir…
$ ultima_carga       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
$ valor_da_acao      &lt;chr&gt; NA, "1.000,00", "1.000.000,00", "1,00", "0,01", "1.…
$ volume_apenso      &lt;chr&gt; "1 / 0", "1 / 0", "1 / 0", "1 / 0", "1 / 0", "1 / 0…</code></pre>
</div>
</div>
<p>Desses dados, nós preservaremos somente o número do processo e o órgão julgador. Além disso, iremos manter somente as câmaras de direito criminal, ajustar sua descrição e convertê-las em fator ordenado.</p>
<p>Igualmente, iremos criar uma nova coluna com a informação de que o processo é originalmente físico, protocolado pelo preso, ou eletrônico desde o início. Para tanto, basta verificar o início do processo. Se começa com 20 é totalmente eletrônico, com 00 é inicialmente físico, ou seja, o pedido foi possivelmente escrito a mão por um pessoa privada de liberdade.</p>
<p>Não iremos usar a informação sobre o crime, mas assim mesmo, vamos reter a informação sobre o crime do assunto. Os casos em que não há informação do crime parecem ser execução penal. Vamos converter esses casos, sem informação sobre o crime, em execução penal.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ordenar_camaras <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="st">"(</span><span class="sc">\\</span><span class="st">s|[:lower:]+)"</span>) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(.,<span class="at">levels =</span> stringr<span class="sc">::</span><span class="fu">str_sort</span>(<span class="fu">unique</span>(.),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="at">numeric =</span> T))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">|&gt;</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">crime =</span> <span class="fu">str_extract</span>(assunto, <span class="st">"(?&lt;=-)[^-]+$"</span>), <span class="at">.after =</span> assunto) <span class="do">## extrai tudo que depois do último hífen.</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">crime =</span> <span class="fu">str_squish</span>(crime)) <span class="sc">|&gt;</span> <span class="do">## remove espaços extra.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">crime =</span> <span class="fu">ifelse</span>(assunto <span class="sc">==</span> <span class="st">"DIREITO PENAL"</span>, <span class="st">"Execução penal"</span>, crime)) <span class="do">## Se houver só a expressão DIREITO PENAL penal no assunto, converte o crime em Execução penal.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(processo, cd_processo, orgao_julgador, crime) <span class="sc">|&gt;</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">camara =</span> <span class="fu">ordenar_camaras</span>(orgao_julgador)) <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">fisico =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(processo, <span class="st">"^0"</span>), <span class="st">"sim"</span>, <span class="st">"não"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A base dispositivos possui quatro colunas, processo, cd_processo, data e dispositivo. Além disso, nem todos os processos contêm a informação da decisão. Na verdade, ao examinar a base é possível saber que houve decisão e é até possível extraí-la da movimentação, mas vamos manter sem essa informação por razões pedagógicas a fim de ilustrar como dados censurados são incorporados na análise.</p>
<p>No código abaixo, usamos a função <code>tjsp_classificar_writ</code> para extrair do dispositivo o teor da decisão. Não usaremos essa informação, mas manteremos na base por sua eventual utilidade. Igualmente, extraímos a informação de que a concessão foi em caráter liminar ou não.</p>
<pre><code>dispositivos &lt;- dispositivos |&gt; 
           mutate(decisao = tjsp_classificar_writ(dispositivo)) |&gt; 
          mutate(liminar = case_when(
         str_detect(dispositivo,"(?i)\\blimin") ~ "sim",
         TRUE ~ "não"
       ))</code></pre>
<p>Vamos extrair da movimentação a primeira movimentação de cada processo, que pode ser interpretada como a distribuição do HC.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>distribuicao <span class="ot">&lt;-</span> movimentacao <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">group_by</span>(processo) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(data<span class="sc">==</span> <span class="fu">min</span>(data)) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">select</span>(processo, <span class="at">data_distribuicao =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Por fim, vamos juntar essas três bases e criar uma nova coluna chamada duração, que é a diferença entre a data da distribuição e a data da decisão. O pacote tjsp tem uma função chamada lapso, que serve para isso. Iremos colocar a duração em dias porque a movimentação não informa a hora. Iremos também adicionar uma coluna informando o status da informação, se foi censurada terá valor 0, se não, valor 1.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> dispositivos <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(processo, liminar, <span class="at">data_decisao =</span> data, decisao) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(dados, <span class="at">by =</span> <span class="st">"cd_processo"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(mov, <span class="at">by =</span> <span class="st">"cd_processo"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">duracao =</span> <span class="fu">lapso</span>(<span class="at">inicio =</span> data_distribuicao, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fim =</span> data_decisao, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">unidade =</span> <span class="st">"dia"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                               ) <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(duracao),<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Por fim, vamos ordenar as colunas e converter as variáveis independentes em fatores</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> base <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(processo, duracao, status, data_distribuicao, data_decisao,  status, camara,crime, liminar, fisico, decisao) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(crime<span class="sc">:</span>decisao, as.factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="análise" class="level2">
<h2 class="anchored" data-anchor-id="análise">Análise</h2>
<p>Estamos em condições de aplicar a análise de duração. Antes, porém, vamos visualizar os dados. São 3174 pedidos julgados. No entanto, há 587 casos censurados porque “não sabemos” quando foram decididos. Sabemos, porém que foram julgados porque todos foram extintos.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,174
Columns: 10
$ processo          &lt;chr&gt; "00100009320228260000", "00099948620228260000", "000…
$ duracao           &lt;dbl&gt; 28, 30, 30, 1000, 44, 9, 65, 20, 14, 61, 72, 40, 6, …
$ status            &lt;dbl&gt; 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0…
$ data_distribuicao &lt;date&gt; 2022-03-30, 2022-03-30, 2022-03-30, 2022-03-30, 202…
$ data_decisao      &lt;date&gt; 2022-04-27, 2022-04-29, 2022-04-29, NA, 2022-05-13,…
$ camara            &lt;fct&gt; 15CDC, 10CDC, 13CDC, 14CDC, 2CDC, 7CDC, 12CDC, 9CDC,…
$ crime             &lt;fct&gt; "Furto Qualificado", "Receptação Qualificada", "Exec…
$ liminar           &lt;fct&gt; não, não, não, não, não, não, não, não, sim, não, nã…
$ formato           &lt;fct&gt; físico, físico, físico, físico, físico, físico, físi…
$ decisao           &lt;fct&gt; prejudicado/extinto, denegado, não conhecido, NA, nã…</code></pre>
</div>
</div>
<p>Para a análise, iremos usar dois pacotes, o <code>survival</code> que já vem instalado com o R e <code>survminer</code>, que serve para gerar gráficos usando o ggplot2.</p>
<p>Instale o <code>surviminer</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"survminer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Carregue os dois pacotes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do pacote survival, usaremos duas funções, Surv e survfit. A primeira cria um objeto “survival” com informações sobre o tempo, o status e o tipo de censura. A segunda roda o modelo Kaplan-Meier com seus respectivos estimadores.</p>
<p>Inicialmente, vamos rodar o modelo sem as variáveis categóricas. Note que eu crio, com a função Surv o objeto. Nela eu coloquei o tempo (duração) e o status. Além disso, está subentendido o tipo de censura, que é à direita.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(duracao, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os resultados mostram que de 3.174 pedidos, tivemos 2.604 decisões conhecidas. As demais foram censuradas. A mediana é de 40 dias. A mediana é mais apropriada que a média em análise de duração porque a distribuição das decisões é mais concentrada nos primeiros momentos, com poucos casos, mas importantes, com alta duração.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>km_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(duracao, status) ~ 1, data = base)

        n events median 0.95LCL 0.95UCL
[1,] 3174   2604     40      39      42</code></pre>
</div>
</div>
<p>Para visualizar os resultados em mais detalhes, vamos usar a função <code>surv_summary</code> do pacote <code>survminer</code>. Vamos também renomear as colunas para nomes mais amigáveis em termos de compreensão.</p>
<p>Mostraremos somente as 15 primeiras linhas e as 11 últimas para caber na página.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sumario <span class="ot">&lt;-</span> <span class="fu">surv_summary</span>(km_fit) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"tempo_em_dias"</span>,<span class="st">"pedidos_pendentes"</span>,<span class="st">"pedidos_decididos"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"n_censurados"</span>,<span class="st">"prob_duracao"</span>,<span class="st">"erro"</span>,<span class="st">"ic_inferior"</span>,<span class="st">"ic_superior"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="dv">120</span><span class="sc">:</span><span class="dv">130</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>sumario</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">tempo_em_dias</th>
<th style="text-align: right;">pedidos_pendentes</th>
<th style="text-align: right;">pedidos_decididos</th>
<th style="text-align: right;">n_censurados</th>
<th style="text-align: right;">prob_duracao</th>
<th style="text-align: right;">erro</th>
<th style="text-align: right;">ic_inferior</th>
<th style="text-align: right;">ic_superior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3174</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9990548</td>
<td style="text-align: right;">0.0005460</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9979863</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3171</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9965343</td>
<td style="text-align: right;">0.0010468</td>
<td style="text-align: right;">0.9985809</td>
<td style="text-align: right;">0.9944920</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">3163</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9952741</td>
<td style="text-align: right;">0.0012231</td>
<td style="text-align: right;">0.9976629</td>
<td style="text-align: right;">0.9928910</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">3159</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9927536</td>
<td style="text-align: right;">0.0015165</td>
<td style="text-align: right;">0.9957087</td>
<td style="text-align: right;">0.9898073</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">3151</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9870825</td>
<td style="text-align: right;">0.0020305</td>
<td style="text-align: right;">0.9910187</td>
<td style="text-align: right;">0.9831620</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">3133</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9773157</td>
<td style="text-align: right;">0.0027042</td>
<td style="text-align: right;">0.9825094</td>
<td style="text-align: right;">0.9721495</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">3102</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9666037</td>
<td style="text-align: right;">0.0032993</td>
<td style="text-align: right;">0.9728745</td>
<td style="text-align: right;">0.9603733</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">3068</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9568368</td>
<td style="text-align: right;">0.0037699</td>
<td style="text-align: right;">0.9639330</td>
<td style="text-align: right;">0.9497928</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">3037</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9495904</td>
<td style="text-align: right;">0.0040896</td>
<td style="text-align: right;">0.9572325</td>
<td style="text-align: right;">0.9420094</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">3014</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9426591</td>
<td style="text-align: right;">0.0043778</td>
<td style="text-align: right;">0.9507821</td>
<td style="text-align: right;">0.9346055</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">2992</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9382483</td>
<td style="text-align: right;">0.0045537</td>
<td style="text-align: right;">0.9466597</td>
<td style="text-align: right;">0.9299116</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">2978</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9272212</td>
<td style="text-align: right;">0.0049729</td>
<td style="text-align: right;">0.9363027</td>
<td style="text-align: right;">0.9182278</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">2943</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9171393</td>
<td style="text-align: right;">0.0053352</td>
<td style="text-align: right;">0.9267800</td>
<td style="text-align: right;">0.9075988</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">2911</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.9089477</td>
<td style="text-align: right;">0.0056179</td>
<td style="text-align: right;">0.9190113</td>
<td style="text-align: right;">0.8989943</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: right;">2885</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.8969754</td>
<td style="text-align: right;">0.0060156</td>
<td style="text-align: right;">0.9076136</td>
<td style="text-align: right;">0.8864619</td>
</tr>
<tr class="even">
<td style="text-align: right;">144</td>
<td style="text-align: right;">581</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1827347</td>
<td style="text-align: right;">0.0375377</td>
<td style="text-align: right;">0.1966859</td>
<td style="text-align: right;">0.1697731</td>
</tr>
<tr class="odd">
<td style="text-align: right;">148</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1824197</td>
<td style="text-align: right;">0.0375773</td>
<td style="text-align: right;">0.1963620</td>
<td style="text-align: right;">0.1694672</td>
</tr>
<tr class="even">
<td style="text-align: right;">152</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1821046</td>
<td style="text-align: right;">0.0376171</td>
<td style="text-align: right;">0.1960382</td>
<td style="text-align: right;">0.1691614</td>
</tr>
<tr class="odd">
<td style="text-align: right;">161</td>
<td style="text-align: right;">578</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1817895</td>
<td style="text-align: right;">0.0376569</td>
<td style="text-align: right;">0.1957143</td>
<td style="text-align: right;">0.1688555</td>
</tr>
<tr class="even">
<td style="text-align: right;">167</td>
<td style="text-align: right;">577</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1814745</td>
<td style="text-align: right;">0.0376968</td>
<td style="text-align: right;">0.1953904</td>
<td style="text-align: right;">0.1685497</td>
</tr>
<tr class="odd">
<td style="text-align: right;">168</td>
<td style="text-align: right;">576</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1811594</td>
<td style="text-align: right;">0.0377369</td>
<td style="text-align: right;">0.1950665</td>
<td style="text-align: right;">0.1682439</td>
</tr>
<tr class="even">
<td style="text-align: right;">173</td>
<td style="text-align: right;">575</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1808444</td>
<td style="text-align: right;">0.0377770</td>
<td style="text-align: right;">0.1947425</td>
<td style="text-align: right;">0.1679381</td>
</tr>
<tr class="odd">
<td style="text-align: right;">190</td>
<td style="text-align: right;">574</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1805293</td>
<td style="text-align: right;">0.0378172</td>
<td style="text-align: right;">0.1944186</td>
<td style="text-align: right;">0.1676323</td>
</tr>
<tr class="even">
<td style="text-align: right;">227</td>
<td style="text-align: right;">573</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1802142</td>
<td style="text-align: right;">0.0378575</td>
<td style="text-align: right;">0.1940946</td>
<td style="text-align: right;">0.1673265</td>
</tr>
<tr class="odd">
<td style="text-align: right;">234</td>
<td style="text-align: right;">572</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1798992</td>
<td style="text-align: right;">0.0378979</td>
<td style="text-align: right;">0.1937706</td>
<td style="text-align: right;">0.1670207</td>
</tr>
<tr class="even">
<td style="text-align: right;">237</td>
<td style="text-align: right;">571</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1795841</td>
<td style="text-align: right;">0.0379385</td>
<td style="text-align: right;">0.1934466</td>
<td style="text-align: right;">0.1667150</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Veja que o primeiro tempo é dois dias, ou seja, depois de dois dias, havia 3174 casos, sendo que três casos foram julgados. Depois de três dias, oito casos foram julgados. A tabela também mostra o número de pedidos pendentes depois de um certo número de dias. Também mostra a probabilidade de pendência, ou seja, a probabilidade de o pedido não ter sido apreciado a cada momento.</p>
<p>A curva de Kaplan-Meier é ilustrativa, veja abaixo. Limitamos no gráfico para 180 dias e colocamos intervalos de dez dias para facilitar a visualização.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(km_fit,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">180</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">break.time.by =</span> <span class="dv">10</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">"Probabilidade de pendência"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"Tempo em dias"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="st">"Tempo para apreciar pedidos de habeas corpus"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ggtheme =</span> <span class="fu">theme_light</span>()</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tempo_do_habeas_corpus_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Veja que a curva mostra a probabilidade de pendência ou duração ao longo do tempo. Isto é, no tempo zero, 100% está pendente. Conforme o tempo passa, a taxa de pendência vai caindo.</p>
</section>
<section id="duração-por-câmara" class="level2">
<h2 class="anchored" data-anchor-id="duração-por-câmara">Duração por câmara</h2>
<p>Vamos agora observar como ficam os tempos quando condicionamos por câmara de direito criminal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(duracao, status) <span class="sc">~</span> camara, <span class="at">data =</span> base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Você pode visualizar os resultados com <code>surv_summary(km_fit)</code>. Aqui iremos apenas gerar os gráficos das curvas de Kaplan-Meier para cada câmara de direito criminal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>curva <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> base,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">break.time.by =</span> <span class="dv">15</span> ,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ylab =</span> <span class="st">"Probabilidade de pendência"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">"Tempo em dias"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ggtheme =</span> <span class="fu">theme_light</span>()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ajusta_etiqueta <span class="ot">&lt;-</span> <span class="cf">function</span>(x) stringr<span class="sc">::</span><span class="fu">str_remove</span>(x, <span class="st">"camara="</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>curva<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strata, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(ajusta_etiqueta)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tempo_do_habeas_corpus_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As curvas sugerem diferenças entre as câmaras criminais. Algumas, como a quinta e a oitava câmaras decidem um número relevante de casos logo nos primeiros dias. Por su vez, a 10ª e a 15ª demoram um pouco mais, mas suas curvas mostram uma redução relevante de casos depois de um certo período.</p>
</section>
<section id="teste-logrank" class="level2">
<h2 class="anchored" data-anchor-id="teste-logrank">Teste Logrank</h2>
<p>Para saber se essas curvas são realmente diferentes, há um teste chamado logrank. Por meio dele, verifica-se de os grupos (câmaras de direito criminal) experimentam diferenças nas curvas, i.e., dado um momento, e.g., 5 dias após o pedido, o número de decisões é o mesmo para cada um, ou difere significativamente. Basicamente o teste compara o número de decisões observadas e o número de decisões esperadas para cada momento e apresenta a soma deles. O teste logrank adotado pelo R é uma aproximação ao teste do Chi Quadrado. Se você não tem familiaridade com o teste do Chi Quadrado, <a href="https://www.youtube.com/watch?v=NTHA9Qa81R8">esse vídeo</a> pode lhe ajudar.</p>
<p>Para realizar o teste, há uma função específica:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>surv_diff <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(duracao, status) <span class="sc">~</span> camara, <span class="at">data =</span> base)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>surv_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(duracao, status) ~ camara, data = base)

               N Observed Expected (O-E)^2/E (O-E)^2/V
camara=1CDC  191      162    149.2   1.09465   1.18900
camara=2CDC  165      144    106.4  13.26440  14.16525
camara=3CDC  192      142    196.8  15.26736  16.93715
camara=4CDC  225      187    231.1   8.40432   9.45539
camara=5CDC  164      149     98.6  25.74522  27.39508
camara=6CDC  231      142    200.6  17.11896  19.10198
camara=7CDC  216      191    183.1   0.34045   0.37579
camara=8CDC  306      290    210.2  30.26589  33.76487
camara=9CDC  190      190    105.4  67.79794  72.79231
camara=10CDC 133      110    128.7   2.71341   2.92378
camara=11CDC 190      176    115.6  31.59349  33.88838
camara=12CDC 153      138    137.6   0.00136   0.00148
camara=13CDC 186      126    178.6  15.48205  17.02984
camara=14CDC 204      143    194.1  13.45849  14.89480
camara=15CDC 224      157    204.1  10.86918  12.08055
camara=16CDC 204      157    163.8   0.28635   0.31276

 Chisq= 264  on 15 degrees of freedom, p= &lt;2e-16 </code></pre>
</div>
</div>
<p>Como se pode observar dos resultados, há diferenças significativas entre as câmaras, p-valor &lt; 0.05. Algumas decidiram mais hebeas corpus do que o esperado a cada momento, outras ficaram aquém do esperado.</p>
</section>
<section id="duração-com-múltiplas-variáveis." class="level2">
<h2 class="anchored" data-anchor-id="duração-com-múltiplas-variáveis.">Duração com múltiplas variáveis.</h2>
<p>Vamos agora incluir o formato entre as variáveis condicionantes do tempo para julgar um HC e ver os resultados grafivamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>km_fit <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(duracao, status) <span class="sc">~</span> camara <span class="sc">+</span> formato, <span class="at">data =</span> base)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>curva <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> base,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">break.time.by =</span> <span class="dv">20</span> ,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">120</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ylab =</span> <span class="st">"Probabilidade de pendência"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">"Tempo em dias"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ggtheme =</span> <span class="fu">theme_light</span>()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>remove_nome <span class="ot">&lt;-</span> <span class="cf">function</span>(x) stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(x, <span class="st">"</span><span class="sc">\\</span><span class="st">w+="</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>curva<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strata, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(remove_nome))<span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tempo_do_habeas_corpus_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Quando olhamos para algumas câmaras, como a 13ª e a 15ª, os processos eletrônicos são julgados muito mais rapidamente e, pior, a maioria dos pedidos físicos nem sequer foram julgados no tempo de 120 dias mostrado no gráfico.</p>
</section>
<section id="indo-além" class="level2">
<h2 class="anchored" data-anchor-id="indo-além">Indo além</h2>
<p>Esse tutorial quis ilustrar o potencial da análise de duração para a jurimetria. Nem sequer exploramos o tema profundamente. Há muito mais questões que podem ser exploradas, como saber se decisões quem tendem a negar o HC saem mais rapidamente ou não. Igualmente, decisões liminares estão sujeitas ao fumus boni iuris e ao periculum in mora. Possivelmente, os tempos se invertem quando deferir uma liminar supostamente gera um perigo (HC) ou quando a o indeferimento gera perigo (medidas protetivas.)</p>
<p>A base está <a href="colocar%20url">disponível</a> para você analisá-la e explorar esses outros aspectos.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>